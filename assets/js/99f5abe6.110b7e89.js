"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[9119],{3905:function(e,n,t){t.d(n,{Zo:function(){return p},kt:function(){return m}});var i=t(7294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function o(e,n){if(null==e)return{};var t,i,a=function(e,n){if(null==e)return{};var t,i,a={},r=Object.keys(e);for(i=0;i<r.length;i++)t=r[i],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)t=r[i],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var l=i.createContext({}),c=function(e){var n=i.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):s(s({},n),e)),t},p=function(e){var n=c(e.components);return i.createElement(l.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return i.createElement(i.Fragment,{},n)}},u=i.forwardRef((function(e,n){var t=e.components,a=e.mdxType,r=e.originalType,l=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),u=c(t),m=a,g=u["".concat(l,".").concat(m)]||u[m]||d[m]||r;return t?i.createElement(g,s(s({ref:n},p),{},{components:t})):i.createElement(g,s({ref:n},p))}));function m(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var r=t.length,s=new Array(r);s[0]=u;var o={};for(var l in n)hasOwnProperty.call(n,l)&&(o[l]=n[l]);o.originalType=e,o.mdxType="string"==typeof e?e:a,s[1]=o;for(var c=2;c<r;c++)s[c]=t[c];return i.createElement.apply(null,s)}return i.createElement.apply(null,t)}u.displayName="MDXCreateElement"},3433:function(e,n,t){t.r(n),t.d(n,{frontMatter:function(){return o},contentTitle:function(){return l},metadata:function(){return c},toc:function(){return p},default:function(){return u}});var i=t(3117),a=t(102),r=(t(7294),t(3905)),s=["components"],o={title:"Using directives",sidebar_position:11},l=void 0,c={unversionedId:"guides/using-directives",id:"guides/using-directives",title:"Using directives",description:"using directives is an experimental language extension that may change in future versions of Scala CLI.",source:"@site/docs/guides/using-directives.md",sourceDirName:"guides",slug:"/guides/using-directives",permalink:"/docs/guides/using-directives",editUrl:"https://github.com/Virtuslab/scala-cli/edit/main/website/docs/guides/using-directives.md",tags:[],version:"current",sidebarPosition:11,frontMatter:{title:"Using directives",sidebar_position:11},sidebar:"tutorialSidebar",previous:{title:"IDE support",permalink:"/docs/guides/ide"},next:{title:"SBT and Mill",permalink:"/docs/guides/sbt-mill"}},p=[{value:"Deprecated syntax",id:"deprecated-syntax",children:[],level:2},{value:"Semantics",id:"semantics",children:[],level:2},{value:"<code>using</code> directives in the Scala CLI",id:"using-directives-in-the-scala-cli",children:[],level:2},{value:"How to comment out using directives?",id:"how-to-comment-out-using-directives",children:[],level:2}],d={toc:p};function u(e){var n=e.components,t=(0,a.Z)(e,s);return(0,r.kt)("wrapper",(0,i.Z)({},d,t,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("div",{className:"admonition admonition-warning alert alert--danger"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"warning")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},(0,r.kt)("inlineCode",{parentName:"p"},"using")," directives is an experimental language extension that may change in future versions of Scala CLI."))),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"using")," directives mechanism lets you define configuration information within ",(0,r.kt)("inlineCode",{parentName:"p"},".scala")," source code files, eliminating the need for build tools to define a dedicated configuration syntax."),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"using")," directives are basically key-value pairs that let you provide multiple values to a single key. For instance, this command:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-scala"},'using foo "bar", "baz"\n')),(0,r.kt)("p",null,"will be interpreted as assigning ",(0,r.kt)("inlineCode",{parentName:"p"},"bar")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"baz")," to the key ",(0,r.kt)("inlineCode",{parentName:"p"},"foo"),"."),(0,r.kt)("p",null,"As shown, ",(0,r.kt)("inlineCode",{parentName:"p"},"using")," directives can be defined using the special keyword ",(0,r.kt)("inlineCode",{parentName:"p"},"using"),". However, this may not be compatible with exisiting tools outside of Scala CLI. Therefore, they can be used in comments using special syntax:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-scala"},'//> using scala "2"\n\n/*> using options "-Xfatal-warnings"*/\n')),(0,r.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"For now we recommend using the special comment (",(0,r.kt)("inlineCode",{parentName:"p"},'//> using scala "3.0.2"'),"), and we will use that syntax in this guide."),(0,r.kt)("p",{parentName:"div"},"Until ",(0,r.kt)("inlineCode",{parentName:"p"},"using")," directives becomes a part of the Scala specification, this is the only way that guarantees that your code will work well with IDEs, code formatters, and other tools."))),(0,r.kt)("p",null,"Within one file, only one flavor of using directives can be used. The keyword-based syntax (",(0,r.kt)("inlineCode",{parentName:"p"},'using scala "3"'),") has precedence over special comments (",(0,r.kt)("inlineCode",{parentName:"p"},'//> using scala "3"'),"). The deprecated, plain comments (",(0,r.kt)("inlineCode",{parentName:"p"},'// using scala "3"'),") have lowest priority."),(0,r.kt)("p",null,"For now ",(0,r.kt)("inlineCode",{parentName:"p"},"using")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"@using")," can be mixed within a given syntax however we strongly suggest not to use deprecated ",(0,r.kt)("inlineCode",{parentName:"p"},"@using"),"."),(0,r.kt)("p",null,"Scala CLI reports warnings for each using directive that does not contribute to the build."),(0,r.kt)("p",null,"With following snippet:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-scala"},'using scala "3.1"\n// using scala "2.13.8"\n//> using scala "2.12.11"\n')),(0,r.kt)("p",null,"Scala ",(0,r.kt)("inlineCode",{parentName:"p"},"3.1")," will be used and following warnings would be reported:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'[warn] ./.pg/a.scala:2:1: This using directive is ignored. File contains directives outside comments and those has higher precedence.\n[warn] // using scala "2.13.8"\n[warn] ^^^\n[warn] ./.pg/a.scala:3:1: This using directive is ignored. File contains directives outside comments and those has higher precedence.\n[warn] //> using scala "2.12.11"\n[warn] ^^^^\n')),(0,r.kt)("h2",{id:"deprecated-syntax"},"Deprecated syntax"),(0,r.kt)("p",null,"As a part of ",(0,r.kt)("inlineCode",{parentName:"p"},"0.0.x")," series we experimented with different syntaxes for using directives. Based on feedback and discussions with the Scala compiler team, we decided to deprecate ",(0,r.kt)("inlineCode",{parentName:"p"},"@using")," (using annotations) and ",(0,r.kt)("inlineCode",{parentName:"p"},"// using")," (using within plain comment). Those syntaxes will keep working in the ",(0,r.kt)("inlineCode",{parentName:"p"},"0.1.x")," series and will result in an error starting from ",(0,r.kt)("inlineCode",{parentName:"p"},"0.2.x"),"."),(0,r.kt)("p",null,"Scala CLI produces warnings if any of the syntaxes above is used:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'[warn] ./.pg/a.scala:1:1: Using directive using plain comments are deprecated, please add `>` to each comment.\n[warn] // using scala "3"\n[warn] ^^^\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'[warn] ./.pg/a.scala:1:1: Deprecated using directive syntax, please use keyword `using`.\n[warn] @using scala "3"\n[warn] ^^^^^^\n')),(0,r.kt)("h2",{id:"semantics"},"Semantics"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"using")," directives can be only declared ",(0,r.kt)("strong",{parentName:"p"},"before any other Scala code"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-scala"},'//> using scala "2.13"\n//> using platform "scala-js"\n//> using options "-Xasync"\n\n// package statements, import statements and other code follows ...\n')),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"using")," directives contribute settings to the whole compilation scope where a given ",(0,r.kt)("inlineCode",{parentName:"p"},".scala")," file is defined.\nThis means that a library or compiler option defined in one file applies to the whole application or test (depending on whether the source file is a test, or not)."),(0,r.kt)("p",null,"The only exceptions are ",(0,r.kt)("inlineCode",{parentName:"p"},"using target")," directives, which only apply to the given file.\n",(0,r.kt)("inlineCode",{parentName:"p"},"using target")," is a marker to assign a given file to a given target (e.g., test or main sources)."),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"using")," directives also support indentation and braces syntax similar to the syntax of Scala:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-scala"},'//> using:\n//>   scala "2.13"\n//>   options "-Xasync"\n//>   target {\n//>     scope "test"\n//>     platform "jvm"\n//>   }\n')),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"We believe that syntax similar to ",(0,r.kt)("inlineCode",{parentName:"strong"},"using")," directives should become a part of Scala in the future.")),(0,r.kt)("h2",{id:"using-directives-in-the-scala-cli"},(0,r.kt)("inlineCode",{parentName:"h2"},"using")," directives in the Scala CLI"),(0,r.kt)("p",null,"Below is a list of the most important ",(0,r.kt)("inlineCode",{parentName:"p"},"using")," directives that Scala CLI supports. The full list can be found in the ",(0,r.kt)("a",{parentName:"p",href:"/docs/reference/directives"},"Reference section of this documentation"),"."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},'//> using scala "<scala-version>"')," - defines version of Scala used"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},'//> using lib "org::name:version"')," - defines dependency to a given library ",(0,r.kt)("a",{parentName:"li",href:"/docs/guides/dependencies"},"more in dedicated guide")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},'//> using lib "org:name:version"'),"  - defines dependency to a given ",(0,r.kt)("strong",{parentName:"li"},"java")," library, note the ",(0,r.kt)("inlineCode",{parentName:"li"},":")," instead of ",(0,r.kt)("inlineCode",{parentName:"li"},"::")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},'//> using lib "org::name:version,url=url"')," - defines dependency to a given library with a fallback to its jar url"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},'//> using resourceDir "<dir>"')," - marks directory as source of resources. Resources accessible at runtime and packaged together with compiled code."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},'//> using `java-opt` "<opt>"')," - use given java options when running application or tests"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},'//> using target ["test"|"main"]')," used to marked or unmarked given source as test"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"//> using `test-framework` <framework> ")," - select test framework to use")),(0,r.kt)("p",null,"There are several reasons that we believe ",(0,r.kt)("inlineCode",{parentName:"p"},"using")," directives are a good solution:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"One of the main Scala CLI use cases is prototyping, and the ability to ship one or more source code files with a complete configuration is a game-changer for this use case."),(0,r.kt)("li",{parentName:"ul"},"Defining dependencies and other settings is common in Ammonite scripts as well."),(0,r.kt)("li",{parentName:"ul"},"From a teaching perspective, the ability to provide pre-configured pieces of code that fit into one slide is also benefical."),(0,r.kt)("li",{parentName:"ul"},"Having configuration close to the code is benefical, since often \u2014 especially in small programs \u2014 the given depencencies are only used within one source file.")),(0,r.kt)("p",null,"We acknowledge that configuration distributed across many source files may be hard to maintain in the long term. Therefore, in the near feature we will introduce a set of lints to ensure that above a given project size or complexity, all configuration details will be centralized."),(0,r.kt)("p",null,"How can configuration that\u2019s contained in source files be centralized?\n",(0,r.kt)("inlineCode",{parentName:"p"},"using")," directives can be placed in any ",(0,r.kt)("inlineCode",{parentName:"p"},".scala")," file, so it\u2019s possible to create a ",(0,r.kt)("inlineCode",{parentName:"p"},".scala")," file that contains only configuration information.\nTherefore, when your project needs to centralize its configuration, we recommend creating a ",(0,r.kt)("inlineCode",{parentName:"p"},"conf.scala")," file, and placing the configuration there.\nWe plan to add ways to Scala CLI to migrate these settings into a centralized location with one command or click."),(0,r.kt)("p",null,"We are aware that ",(0,r.kt)("inlineCode",{parentName:"p"},"using")," directives may be a controversial topic, so we\u2019ve created a ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/VirtusLab/scala-cli/discussions/categories/using-directives-and-cmd-configuration-options"},"dedicated space for discussing ",(0,r.kt)("inlineCode",{parentName:"a"},"using")," directives"),"."),(0,r.kt)("h2",{id:"how-to-comment-out-using-directives"},"How to comment out using directives?"),(0,r.kt)("p",null,"Using directives are part of the code so similarly, developers should be able to comment them out. Until 0.2.x when plain comment syntax will be removed commenting out using directives requires special care."),(0,r.kt)("p",null,"Paradoxically, commenting out comment-based directives does not cause any problems. Below, some examples how to do it:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-scala",metastring:"compile",compile:!0},'// //> using lib "no::lib:123"\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-scala",metastring:"compile",compile:!0},'// // using lib "no::lib:123"\n')),(0,r.kt)("p",null,"Until plain using directives in plain comments are supported, commenting keyword base syntax require some attention. Let' assume that we have a following code:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-scala",metastring:"fail",fail:!0},'using scala "3.1.1"\nusing lib "no::lib:123"\n')),(0,r.kt)("p",null,"and we want to comment out broken using directive: ",(0,r.kt)("inlineCode",{parentName:"p"},'lib "no::lib:123"')," when we simply comment it out we will actually turn it into a using directive that is using a plain comment syntax!"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-scala",metastring:"compile",compile:!0},'using scala "3.1.1"\n// using lib "no::lib:123"\n')),(0,r.kt)("p",null,"In cases where there are other uncommented directives, scala-cli will ignore that directives, producing a warning. In cases that this is the only directive in the file, the commented directive will be still used to configure build."),(0,r.kt)("p",null,"In such cases we suggest to use triple ",(0,r.kt)("inlineCode",{parentName:"p"},"/")," for single line comments, or use ",(0,r.kt)("inlineCode",{parentName:"p"},"//")," withing multiline comments:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-scala",metastring:"compile",compile:!0},'/// using lib "in::single-line-comments:123"\n/*\n// using lib "in::multiline-line-comments:123" \n*/\n')),(0,r.kt)("p",null,"Generally, our recommendation is to not use keyword based directives until scala-cli will stop supporting plain comments-based directives."))}u.isMDXComponent=!0}}]);